<?require($_SERVER["DOCUMENT_ROOT"]."/bitrix/header.php");$APPLICATION->SetTitle("Управление импортом каталога товаров");/**если была отправка файла, то сохраняем его на сервере*/if(count($_FILES)){	$csv_file = $_FILES['csv']["name"];		$csv_file_path = $_SERVER["DOCUMENT_ROOT"]."/upload/export-files/".$csv_file;	if(!copy($_FILES['csv']["tmp_name"], $csv_file_path))		die("Не удалось загрузить файл! ");	$scheme = $_POST['scheme'];		$xmlLink = createXmlExportCsvLink($csv_file, $scheme);	print "Ссылка на xml для импорта: <a href='{$xmlLink}'>{$xmlLink}</a>";}else{?><form action="." enctype="multipart/form-data" method="POST"><input type="file" name="csv" value="загрузить csv-файл со списком позиций"/><select name="scheme">	<option disabled>Выберите схему импорта</option>	<option value="yml" selected>YML (формат Яндекс-маркета: market.yandex.ru, energoportal.ru и т.д.)</option>	<option value="elec">xml Elec.ru</option></select><input type="submit"/></form>
<?}print "<h2>Загруженные ранее файлы: </h2><ol>";foreach (glob($_SERVER["DOCUMENT_ROOT"]."/upload/export-files/*.csv") as $filename){	print "<li><b><a target='_blank' href='http://{$_SERVER['SERVER_NAME']}/upload/export-files/".basename($filename)."'>".basename($filename)."</a></b>		(upload: ".date('r', fileatime($filename))." ) 	<a href='".createXmlExportCsvLink(basename($filename), 'yml')."' target='_blank'>YML</a> |	<a href='".createXmlExportCsvLink(basename($filename), 'elec')."' target='_blank'>elec.ru xml</a> |	<a href='".createXmlExportCsvLink(basename($filename), 'elprofi')."&amp;out=csv' target='_blank'>elprofi.ru csv</a> |	<a href='".createXmlExportCsvLink(basename($filename), 'data')."' target='_blank'>full-data xml</a>	</li>";}print "</ol>";function createXmlExportCsvLink($csv_file, $scheme){	return "http://{$_SERVER['SERVER_NAME']}/efscripts/export/from-csv.php?file={$csv_file}&amp;scheme={$scheme}";}require($_SERVER["DOCUMENT_ROOT"]."/bitrix/footer.php");?>