
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head>
<META name="keywords" content="Битрикс управление сайтом документация PHP код страница как сделать сайт на PHP">
<script type="text/JavaScript"> if (window.name != "content") window.location = "../../../index.html?page=source%2Fservice%2Fmail%2Fmail_filter_edit.php.html"; </script>

<title>Создание и редактирование правила</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<meta http-equiv="Content-Language" content="ru">

<style>@import url(../../docstyle.css);</style>

<script src="../../wow.js"></script>

<script type="text/JavaScript">
top.pageid = "service/mail/mail_filter_edit.php.html";
</script>

</head>

<body id="dxBody" topMargin="0" onload="bodyLoad()">
<!-- this header was added by chm2web -->

<div id="pagetop">
<div id="projectnamebanner">
<table class="projectnametable" cellSpacing="0">
	<tr>
		<td>1С-Битрикс: Управление сайтом</td>
		<td class="feedback"><a 
      href="mailto:support@bitrixsoft.ru?subject=Вопрос%20по%20документации%20(Топик [Создание и редактирование правила])">Отправить 
      отзыв</a> по этому разделу&nbsp;&nbsp;&nbsp;</td></tr>
</table></div>
<div id="pagetitlebanner">
<h1 class="Banner">Создание и редактирование правила</h1></div></div>
<div id="pagebody" valign="bottom">
 
<p>Форма <b>редактирования параметров правила </b>предназначена для создания новых правил обработки почтовых сообщений и редактирования уже созданных. Для создания нового правила вам следует заполнить поля формы и нажать кнопку <b>Сохранить</b>.</p>
 
<h2><a name="list"></a>Форма параметров правила</h2>
 
<h4>Вкладка &quot;Параметры&quot;</h4>
 
<table class="tnormal"> 	 
  <tbody> 
    <tr> 		<th>Поле</th> 		<th>Описание</th></tr>
   	 
    <tr> 		<td>Код</td> 		<td>Код правила, под которым оно было сохранено. 
        <br />
       
        <br />
       <b>Отображается при редактировании существующего правила.</b></td></tr>
   	 
    <tr> 		<td>Последнее изменение</td> 		<td>Дата и время последнего изменения правила. 
        <br />
       
        <br />
       <b>Отображается при редактировании существующего правила.</b></td></tr>
   	 
    <tr> 		<td>Почтовый ящик</td> 		<td>Почтовый ящик, к которому должно применяться это правило. Для создания нового почтового ящика, вы можете кликнуть ссылку <b>Создать</b>.</td></tr>
   	 
    <tr> 		<td>Активность</td> 		<td>Если этот флаг установлен, правило активно и может быть применено к сообщениям. 
        <br />
       Если флаг не установлен, правило не применяется к сообщениям. 
        <br />
       
        <br />
       См. тж. поле <font class="tablefieldtext"><i>Применять при событиях</i>.</font></td></tr>
   	 
    <tr> 		<td>* Название</td> 		<td>Любое осмысленное название данного правила.</td></tr>
   	 
    <tr> 		<td>Описание</td> 		<td>Произвольное описание правила.</td></tr>
   	 
    <tr> 		<td>Сортировка</td> 		<td>Вес сортировки правила; применяется при отображении правила в списке.</td></tr>
   	 
    <tr> 		<td>Применять при событиях</td> 		<td>Типы событий, при которых следует применять это правило: 			 
        <ul> 				 
          <li><b>При получении почты</b> - если флаг установлен, правило будет применяться к каждому сообщению при получении почты с почтового ящика, для которого создано это правило. Если флаг сброшен, правило не будет автоматически применяться при получении почты; 				</li>
         
          <li><b>При принудительном вызове правила</b> - если флаг установлен, правило можно будет применить в ручном режиме.&nbsp; 	</li>
         </ul>
       </td></tr>
   </tbody>
 </table>
 * - Поля, обязательные для заполнения. 
<h4>Вкладка &quot;Условия&quot;</h4>
 
<table class="tnormal"> 	 
  <tbody> 
    <tr> 		<th>Поле</th> 		<th>Описание</th></tr>
   	 
    <tr> 		<td>Группы полей для задания условий</td> 		<td>Задание условий предварительной фильтрации сообщений перед тем как к ним будет применено данное правило.&nbsp; 
        <br />
       
        <br />
       Для получения подробной информации по полям группы см. <a href="#condition">примечания</a> ниже.</td></tr>
   	 
    <tr> 		<td>Вероятность, что сообщение спам</td> 		<td>Правило будет применяться только к сообщениям, параметр <b>СПАМ коэф.</b> которых&nbsp; удовлетворяет этому условию; т.е. больше или меньше уровня, задаваемого в процентах.&nbsp; 
        <br />
       
        <br />
       Например, если выставить данное условие в &quot;<i>больше 90%</i>&quot;, то правило будет применяться только к тем сообщениям, вероятность спама которых превышает 90%.</td></tr>
   	 
    <tr> 		<td>Размер сообщения</td> 		<td>Правило будет применяться только к сообщениям, размер которых удовлетворяет этому условию.</td></tr>
   	 
    <tr> 		<td>Условие на PHP скрипте</td> 		<td>Опциональный PHP скрипт, который исполняется во время определения возможности применения правила к сообщению. PHP скрипт должен определить допустимость применения правила к сообщению и вернуть значение 			<code>true</code> или <code>false</code>. 
        <br />
       
        <br />
       Для получения подробной информации об этом поле см. <a href="#condition">примечания</a> ниже.</td></tr>
   	 
    <tr> 		<th colspan="2">Настройки добавления сообщения в техподдержку 
        <br />
       Эта группа настроек отображается только при создании правила с шаблоном &quot;Добавление сообщения в техподдержку&quot;</th></tr>
   	 
    <tr> 		<td>Определять по E-Mail ранее зарегистрированного пользователя</td> 		<td>Если это условие установлено в <b>да...</b>, то при получении нового сообщения правило будет предпринимать попытки найти зарегистрированного пользователя с таким адресом в базе данных и привязать сообщение к нему. 
        <br />
       В противном случае, при получении писем с любых адресов сообщения в модуле техподдержки будут создаваться как анонимные.</td></tr>
   	 
    <tr> 		<td>Добавлять новое сообщение в уже открытое обращение</td> 		<td>Условие определяет, сообщения с какого адреса могут быть добавлены в открытое обращение в техподдержку.&nbsp; 
        <br />
       
        <br />
       При установке флага 			<b>как скрытое...</b> сообщение будет доступно только сотрудникам техподдержки.</td></tr>
   	 
    <tr> 		<td>Шаблоны темы для определения ответа на обращение</td> 		<td>Регулярные выражения, применяемые для сортировки входящих сообщений. Поле предназначено для разработчиков; не рекомендуется изменять его значение без надобности.</td></tr>
   	 
    <tr> 		<td>Привязывать новое обращение к сайту</td> 		<td>Указание на сайт, к которому будет привязано вновь создаваемое обращение.</td></tr>
   	 
    <tr> 		<td>Привязывать новое обращение к категории</td> 		<td>Указание категории обращения, к которой будет привязано вновь создаваемое обращение.</td></tr>
   	 
    <tr> 		<td>Назначить новому обращению критичность</td> 		<td>Позволяет указать критичность вновь создаваемого обращения.</td></tr>
   </tbody>
 </table>
 
<table class="tnormal"> </table>
 
<h4>Вкладка &quot;Действия&quot;</h4>
 
<table class="tnormal"> 	 
  <tbody> 
    <tr> 		<th>Поле</th> 		<th>Описание</th></tr>
   	 
    <tr> 		<td>Установить статус прочтенности</td> 		<td>Позволяет отметить все сообщения, к которым будет применяться это правило, как прочитанные.</td></tr>
   	 
    <tr> 		<td>Установить пометку спам</td> 		<td>Позволяет отметить все сообщения, к которым будет применяться это правило, как сообщения массовой рассылки.</td></tr>
   	 
    <tr> 		<td>Действие на PHP скрипте</td> 		<td>Опциональный PHP скрипт, который исполняется во время применения правила к сообщению.</td></tr>
   	 
    <tr> 		<td>Удалить сообщение</td> 		<td>Удаляет сообщения, к которым применяется правило.</td></tr>
   	 
    <tr> 		<td>Не обрабатывать другими правилами</td> 		<td>Указывает, что после применения этого правила к конкретному сообщению, остальные правила не будут применены к нему, даже если сообщение удовлетворяет условиям правила.</td></tr>
   </tbody>
 </table>
 
<h2>Примечания</h2>
 
<h4><a name="condition"></a>Группы полей для задания условий</h4>
 <img src="../../images/iblock/b3c/mail_rule.png" width="569" height="83"> 
<p>Первый выпадающий список группы содержит перечень текстовых свойств сообщения, которые являются источником информации для фильтра (<b>операнд</b>).&nbsp;</p>
 
<p>Второй выпадающий список содержит перечень <b>компаративных операторов </b>(операторов сравнения), определяющих тип операции сравнения, применяемой к тексту свойства, выбранного в первом списке при фильтрации.&nbsp;В качестве функционального оператора может быть выбран пункт <b>Регулярное выражение</b>. Синтаксис используемых регулярных выражений соответствует спецификации <span style="font-weight: bold;">PCRE</span>. Описание синтаксиса можно найти здесь: <a target="_blank" href="http://ru2.php.net/manual/en/reference.pcre.pattern.syntax.php">http://ru2.php.net/manual/en/reference.pcre.pattern.syntax.php</a>.</p>
 
<p>Поле ввода текста предназначено для ввода <b>образца текста</b>, с которым производится сравнение текста свойства первого списка.</p>
 
<h5>Пример</h5>
 
<p>Для того чтобы правило применялось ко всем входящим сообщениям, в поле <b>Тема</b> которых присутствует слово &quot;Заказ&quot;, установите следующие значения полей:</p>
 
<ul> 	 
  <li><b>Операнд</b> - Тема<i>;</i> 	</li>
 
  <li><b>Оператор</b> - Содержит<i>;</i> 	</li>
 
  <li><b>Образец</b> - Заказ. </li>
 </ul>
 
<h4>&nbsp;Условие на PHP скрипте</h4>
 
<p>Поставляемые возможности в большинстве случаев достаточны для задания условий отбора сообщений. Однако, если стандартные механизмы не позволяют реализовать требуемые условия отбора сообщений, предусмотрена возможность создания пользовательских программных условий отбора. Скрипт для отбора сообщений должен быть написан на языке PHP. Во время выполнения условного скрипта гарантируется валидность массива полей сообщения <code style="font-style: italic;">$arMessageFields</code>.</p>
 
<p>Условный PHP-скрипт должен вернуть <code style="font-style: italic;">true</code>, если условие выполняется и к сообщению может быть применено правило, или <code style="font-style: italic;">false</code> в противном случае.</p>
 
<h5>Пример</h5>
 
<pre id="xmpB5FA228B" class="syntax">if ($arMessageFields[&quot;FIELD_PRIORITY&quot;] &gt; 3 || strpos($arMessageFields[&quot;FIELD_FROM&quot;], &quot;@bitrix&quot;) &gt; 0)<br />   return true;<br />return false;<br /></pre>
 <bitrix:sys name="feedbackform"></bitrix:sys>

<table id="topicfooter">
	<tr>
		<td>© «Битрикс», 2001-2008, «1C-Битрикс», 2008</td>
		<td style="width: 50px">&nbsp;</td>
		<td style="text-align: right"><a href="http://www.1c-bitrix.ru" target="_blank">1С-Битрикс: Управление сайтом</a></td></tr>
</table></div>
<script type="text/JavaScript" src="../../../files/supply.js"></script>
<script type="text/JavaScript">
var fe = FindFrame("toc", top);
if ((fe != null) && (top.jstree != null)) {
  if (top.FITEMS[top.pagenum] != top.pageid)
    top.jstree.OpenTreeNode("source/" + top.pageid);
}
</script>
</body></html>
